{% extends 'base.html' %}

{% block title %}Cardápio Mágico - Expresso Patronum{% endblock %}

{% block content %}
<div class="row">
    <div class="col-12">
        <div class="magical-card text-center">
            <h2 style="font-family: 'Cinzel', serif; color: #8B0000; font-size: 2.5rem;">
                📜 Cardápio das Poções Mágicas 📜
            </h2>
            <p style="font-size: 1.2rem; color: #3C2415; margin-top: 1rem;">
                Explore nossas bebidas encantadas, cada uma com propriedades mágicas únicas!
            </p>
        </div>
    </div>
</div>

<!-- Filtros Mágicos -->
<div class="row mt-4">
    <div class="col-12">
        <div class="magical-card">
            <h4 style="font-family: 'Cinzel', serif; color: #3C2415; margin-bottom: 1rem;">
                🔍 Filtros de Busca Mágica
            </h4>
            <div class="row">
                <div class="col-md-4">
                    <div class="form-group">
                        <label>Tipo de Poção:</label>
                        <select class="form-control" id="filtro-tipo">
                            <option value="">Todas as Poções</option>
                            <option value="cafe">☕ Cafés Mágicos</option>
                            <option value="cha">🍵 Chás Encantados</option>
                            <option value="especial">✨ Poções Especiais</option>
                        </select>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="form-group">
                        <label>Casa de Hogwarts:</label>
                        <select class="form-control" id="filtro-casa">
                            <option value="">Todas as Casas</option>
                            <option value="gryffindor">🦁 Grifinória</option>
                            <option value="slytherin">🐍 Sonserina</option>
                            <option value="ravenclaw">🦅 Corvinal</option>
                            <option value="hufflepuff">🦡 Lufa-Lufa</option>
                        </select>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="form-group">
                        <label>Preço Máximo:</label>
                        <select class="form-control" id="filtro-preco">
                            <option value="">Qualquer Valor</option>
                            <option value="10">Até R$ 10,00</option>
                            <option value="15">Até R$ 15,00</option>
                            <option value="20">Até R$ 20,00</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Menu Grid -->
<div class="menu-grid" id="cardapio-grid">
    {% for bebida in bebidas %}
    <div class="beverage-card" data-tipo="{{ bebida.tipo }}" data-casa="{{ bebida.casa }}" data-preco="{{ bebida.preco }}">
        <h3>{{ bebida.nome }}</h3>
        <div class="house-gem {{ bebida.casa }}" style="margin: 0.5rem auto;"></div>
        <p style="color: #3C2415;">
            {{ bebida.descricao }}
        </p>
        <ul class="ingredients-list">
            {% for ingrediente in bebida.ingredientes %}
            <li>{{ ingrediente }}</li>
            {% endfor %}
        </ul>
        <div class="price">R$ {{ bebida.preco }}</div>
        <a href="{% url 'menu:personalizar' bebida.id %}" class="magical-btn">
            ⚡ Personalizar Poção
        </a>
    </div>
    {% endfor %}
</div>

<!-- Ingredientes Extras -->
<div class="row mt-5">
    <div class="col-12">
        <div class="magical-card">
            <h3 style="font-family: 'Cinzel', serif; color: #8B0000; text-align: center; margin-bottom: 2rem;">
                🧪 Ingredientes Mágicos Disponíveis 🧪
            </h3>
            
            <div class="row">
                <div class="col-md-3 text-center mb-3">
                    <div style="font-size: 2rem; margin-bottom: 0.5rem;">🥛</div>
                    <h6>Leites Encantados</h6>
                    <p style="font-size: 0.9rem;">Leite de aveia, amêndoas, coco ou tradicional</p>
                    <!-- <span style="color: #D4AF37; font-weight: bold;">+R$ 1,50</span> -->
                </div>
                <div class="col-md-3 text-center mb-3">
                    <div style="font-size: 2rem; margin-bottom: 0.5rem;">🍯</div>
                    <h6>Doçuras Mágicas</h6>
                    <p style="font-size: 0.9rem;">Açúcar cristal, mel, xarope de agave</p>
                    <!-- <span style="color: #D4AF37; font-weight: bold;">+R$ 0,80</span> -->
                </div>
                <div class="col-md-3 text-center mb-3">
                    <div style="font-size: 2rem; margin-bottom: 0.5rem;">🌿</div>
                    <h6>Especiarias</h6>
                    <p style="font-size: 0.9rem;">Canela, cardamomo, baunilha, noz-moscada</p>
                    <!-- <span style="color: #D4AF37; font-weight: bold;">+R$ 1,00</span> -->
                </div>
                <div class="col-md-3 text-center mb-3">
                    <div style="font-size: 2rem; margin-bottom: 0.5rem;">✨</div>
                    <h6>Extras Especiais</h6>
                    <p style="font-size: 0.9rem;">Chantilly, marshmallow, chocolate</p>
                    <!-- <span style="color: #D4AF37; font-weight: bold;">+R$ 2,00</span> -->
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Funcionalidade de filtros
    const filtroTipo = document.getElementById('filtro-tipo');
    const filtroCasa = document.getElementById('filtro-casa');
    const filtroPreco = document.getElementById('filtro-preco');
    const cards = document.querySelectorAll('.beverage-card');

    function aplicarFiltros() {
        const tipoSelecionado = filtroTipo.value;
        const casaSelecionada = filtroCasa.value;
        const precoMaximo = parseFloat(filtroPreco.value) || Infinity;

        cards.forEach(card => {
            const tipo = card.dataset.tipo;
            const casa = card.dataset.casa;
            const preco = parseFloat(card.dataset.preco);

            const mostraCard = 
                (tipoSelecionado === '' || tipo === tipoSelecionado) &&
                (casaSelecionada === '' || casa === casaSelecionada) &&
                (preco <= precoMaximo);

            if (mostraCard) {
                card.style.display = 'block';
                card.style.opacity = '1';
                card.style.transform = 'scale(1)';
            } else {
                card.style.opacity = '0';
                card.style.transform = 'scale(0.8)';
                setTimeout(() => {
                    if (card.style.opacity === '0') {
                        card.style.display = 'none';
                    }
                }, 300);
            }
        });
    }

    filtroTipo.addEventListener('change', aplicarFiltros);
    filtroCasa.addEventListener('change', aplicarFiltros);
    filtroPreco.addEventListener('change', aplicarFiltros);

    // Animação inicial dos cards
    cards.forEach((card, index) => {
        setTimeout(() => {
            card.style.opacity = '1';
            card.style.transform = 'translateY(0)';
        }, index * 100);
        
        card.style.opacity = '0';
        card.style.transform = 'translateY(30px)';
        card.style.transition = 'all 0.4s ease';
    });
});
</script>
{% endblock %}
